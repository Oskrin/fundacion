<div class="loading2" id="loading2">&#8230;</div>
<div class="main-content-inner">
	<div class="breadcrumbs ace-save-state" id="breadcrumbs">
		<ul class="breadcrumb">
			<li>
				<i class="ace-icon fa fa-home home-icon"></i>
				<a href="#">Home</a>
			</li>
			<li>
				<a href="#">Facturacion</a>
			</li>			
			<li class="active">Comprobantes de Retención</li>
		</ul><!-- /.breadcrumb -->
	</div>
	<div class="page-content">
		<div class="row">
			<div class="col-md-12">
				<div class="widget-box">
					<div class="widget-body">
						<div class="widget-main">
							<div id="fuelux-wizard-container">
								<div>
									<ul class="steps">
										<li data-step="1" class="active">
											<span class="step">1</span>
											<span class="title">Información General</span>
										</li>
										<li data-step="2">
											<span class="step">2</span>
											<span class="title">Detalles Comprobante</span>
										</li>
										<li data-step="3">
											<span class="step">3</span>
											<span class="title">Generar Comprobante</span>
										</li>
									</ul>
								</div>
								<hr />
								<div class="step-content pos-rel">
									<div class="step-pane active" data-step="1">
										<form class="form-horizontal"  role="form" id="formGeneral" name="formGeneral" ng-submit="submitForm(formGeneral.$valid)" novalidate>
											<div class="col-sm-12">
												<div class="col-sm-9">
													<div class="form-group">
														<label for="select_empresa" class="col-sm-3 control-label bolder" >Empresa:</label>	
														<div class="col-sm-9">
															<select id="selectEmpresa" name="selectEmpresa" class="chosen-select form-control" data-placeholder="Seleccione..." chosen ng-model="recipientsEmpresa" ng-options = "recipientEmpresa.id as recipientEmpresa.title  for recipientEmpresa in recipientsEmpresaList track by recipientEmpresa.id" ng-change="updateForm(recipientsEmpresa)">
																<option value=""> </option>
															</select>
														</div>
													</div>
													<div class="form-group">
														<label for="selectTipoIdentificacion" class="col-sm-3 control-label bolder" >Identificación:</label>	
														<div class="col-sm-5">											 	  	
															<select id="selectTipoIdentificacion" name="selectTipoIdentificacion" class="chosen-select form-control" data-placeholder="Seleccione..." chosen ng-model="recipients" ng-options = "recipient.id as recipient.title for recipient in recipientsList track by recipient.id" ng-change="updateFormIdentificacion(recipients)">
															</select> 
													    </div>
														<div class="col-sm-4" ng-class="{ 'has-error' : formGeneral.txt_1.$invalid && !formGeneral.txt_1.$pristine }">	
															<input type="text" class="form-control" name="txt_1" placeholder="Número Identificación " ng-model="General.txt_1" required> 															
													    </div>
													</div>
													<div class="form-group" ng-class="{ 'has-error' : formGeneral.txt_2.$invalid && !formGeneral.txt_2.$pristine }">
														<label for="txt_2" class="col-sm-3 control-label bolder">Nombre Comercial:</label>
													    <div class="col-sm-9">
													 		<input type="text" class="form-control" name="txt_2" placeholder="Nombre Comercial" ng-model="General.txt_2"  ng-pattern="/^[^']+$/" required>													 	    
													    </div>
													</div>
													<div class="form-group" ng-class="{ 'has-error' : formGeneral.txt_3.$invalid && !formGeneral.txt_3.$pristine }">
														<label for="txt_3" class="col-sm-3 control-label bolder">Razón Social:</label>
													    <div class="col-sm-9">
													 		<input type="text" class="form-control" name="txt_3" placeholder="Razón Social" ng-model="General.txt_3"  ng-pattern="/^[^']+$/" required>													 	    
													    </div>
													</div>
													<div class="form-group" ng-class="{ 'has-error' : formGeneral.txt_4.$invalid && !formGeneral.txt_4.$pristine }">
														<label for="txt_4" class="col-sm-3 control-label bolder">Dirección:</label>
													    <div class="col-sm-9">
													 		<input type="text" class="form-control" name="txt_4" placeholder="Dirección" ng-model="General.txt_4" ng-pattern="/^[^']+$/" required>													 	    
													    </div>
													</div>
													<div class="form-group" ng-class="{ 'has-error' : formGeneral.txt_5.$invalid && !formGeneral.txt_5.$pristine }">
														<label for="txt_5" class="col-sm-3 control-label bolder">Teléfono:</label>
													    <div class="col-sm-9">
													 		<input type="text" class="form-control" name="txt_5" placeholder="Teléfono" ng-model="General.txt_5" required>													 	    
													    </div>
													</div>
													<div class="form-group" ng-class="{ 'has-error' : formGeneral.txt_6.$invalid && !formGeneral.txt_6.$pristine }">
														<label for="txt_6" class="col-sm-3 control-label bolder">Correo:</label>
													    <div class="col-sm-9">
													 		<input type="email" class="form-control" name="txt_6" placeholder="Correo Electrónico" ng-model="General.txt_6" required>													 	    
													    </div>
													</div>
												</div>
												<div class="col-sm-3">
													<div class="form-group">
														<div ng-class="{ 'has-error' : formGeneral.txt_7.$invalid && !formGeneral.txt_7.$pristine }">
														    <div class="col-sm-6">
														 		<input type="text" class="form-control" name="txt_7" placeholder="Establecimiento" ng-disabled="true" ng-model="General.txt_7" required>													 	    
														    </div>
														</div>
														<div ng-class="{ 'has-error' : formGeneral.txt_8.$invalid && !formGeneral.txt_8.$pristine }">
														    <div class="col-sm-6">
														 		<input type="text" class="form-control" name="txt_8" placeholder="Punto de Emisión" ng-disabled="true" ng-model="General.txt_8" required>													 	    
														    </div>
														</div>
													</div>
													<div class="form-group">
														<div class="col-sm-12">											 	  	
															<button type="button" id="btnBuscarDatos" name="btnBuscarDatos" ng-click="buscarDatos()" class="col-sm-12 btn btn-sm btn-primary">														
																Buscar Datos													
															</button>	
													    </div>
												    </div>													
													<div class="form-group">												
													    <div class="col-sm-12">
															<select id="select_obligacion" name="select_obligacion" tabindex="8" class="chosen-select form-control" data-placeholder="Seleccione...">	
																<option value="SI"> Llevar Contabilidad: SI</option>
																<option value="NO"> Llevar Contabilidad: NO</option>														
															</select>												 	   
													    </div>
													</div>
													<div class="form-group" ng-class="{ 'has-error' : formGeneral.txt_9.$invalid && !formGeneral.txt_9.$pristine }">														
													    <div class="col-sm-12">													    
													    	 <div class='input-group date' id='txt_9'>
														 		<input type="text" class="form-control" name="txt_9" placeholder="Fecha de Emisión " ng-model="General.txt_9" required>
														 	    <span class="input-group-addon">
											                        <span class="glyphicon glyphicon-calendar"></span>
											                    </span>														 	   
													 	   </div>
													    </div>
													</div>
													<div class="form-group">														
														<div class="col-sm-12">
															<select id="selectComprobante" name="selectComprobante" class="chosen-select form-control" data-placeholder="Seleccione..." chosen ng-model="recipientsTipo" ng-options = "recipientTipo.id as recipientTipo.title for recipientTipo in recipientsListTipo track by recipientTipo.id">
																<option value=""> </option>
															</select>
														</div>
													</div>
													<div class="form-group">														
														<div class="col-sm-7">
															<select id="selectMes" name="selectMes" class="chosen-select form-control" data-placeholder="Seleccione..." chosen >
																<option value="01">Enero</option>
																<option value="02">Febrero</option>
																<option value="03">Marzo</option>
																<option value="04">Abril</option>
																<option value="05">Mayo</option>
																<option value="06">Junio</option>
																<option value="07">Julio</option>
																<option value="08">Agosto</option>
																<option value="09">Septiembre</option>
																<option value="10">Octubre</option>
																<option value="11">Noviembre</option>
																<option value="12">Diciembre</option>
															</select>
														</div>
														<div class="col-sm-5">
															<select id="selectAnio" name="selectAnio" class="chosen-select form-control" data-placeholder="Seleccione..." chosen >																
																<option value="2012">2012</option>
																<option value="2013">2013</option>
																<option value="2014">2014</option>
																<option value="2015">2015</option>
																<option value="2016">2016</option>
																<option value="2017" selected="">2017</option>
																<option value="2018">2018</option>
																<option value="2019">2019</option>
																<option value="2020">2020</option>
																<option value="2021">2021</option>
																<option value="2022">2022</option>
															</select>
														</div>
													</div>
													<div class="form-group" ng-class="{ 'has-error' : formGeneral.txt_10.$invalid && !formGeneral.txt_10.$pristine }">
													    <div class="col-sm-12">
													 	   <input type="text" class="form-control" ng-keypress="soloNumeros($event)" ng-minlength="15" ng-maxlength="15" name="txt_10" placeholder="Numero Comprobante " ng-model="General.txt_10" required>
													    </div>
													</div>
												</div>
											</div>
										</form>
									</div>
									<div class="step-pane" data-step="2">	
										<form class="form-horizontal" id="form_informacionGeneral">														
											<div class="form-group">
												<div class=" colsm-12 col-md-3">											 	  	
													<select id="select_codigoRetencion" name="select_codigoRetencion" class="chosen-select form-control" data-placeholder="Código de Retención" chosen ng-model="recipientsCodigoRetencion" ng-options = "recipientCodigoRetencion.id as recipientCodigoRetencion.title for recipientCodigoRetencion in recipientsListCodigoRetencion track by recipientCodigoRetencion.id" ng-change="changeSelectImpuesto(recipientsCodigoRetencion)">
														<option value=""></option>
													</select> 
											    </div>
											    <div class=" col-sm-12 col-md-3">											 	  	
													<select id="select_Retencion" name="select_Retencion" class="chosen-select form-control" data-placeholder="Código de Impuesto" chosen ng-model="recipientsImpuesto" ng-options = "recipientImpuesto.id as recipientImpuesto.title for recipientImpuesto in recipientsListImpuesto track by recipientImpuesto.id" ng-change="updatePorcentaje(recipientsImpuesto)">
														<option value=""></option>
													</select> 
											    </div>
											    
											    <div class="col-sm-2">	
													<input type="text" class="form-control" name="txt_10" placeholder="% Retención" required ng-disabled="true" ng-model="Detalles.txt_10">
											    </div>
											    <div class="col-sm-2">	
													<input type="text" class="form-control" name="txt_11" placeholder="Base Imponible " required ng-model="Detalles.txt_11">	
											    </div>
											    <div class="col-sm-2">											 	  	
													<button type="button" id="btnAgregar" name="btnAgregar" ng-click="agregarDatos()" class="col-sm-12 btn btn-sm btn-primary">
														Agregar
													</button>	
											    </div>
											</div>	
											<div class="form-group">
												<div class="col-sm-12 table-responsive">																
													<table id="tabla_comprobante" class="table table-striped table-bordered table-hover">
														<thead>
															<tr>
																<th style="display:none;">idCodigo</th>																			
																<th>Ejercicio Fiscal</th>
																<th style="display:none;">idCodigoImpuesto</th>
																<th>Codigo Impuesto</th>
																<th>Base Imponible</th>
																<th style="display:none;">idRetencion</th>
																<th>Impuesto</th>
																<th>% Retención</th>
																<th>Valor Retenido</th>
																<th></th>
															</tr>
														</thead>
														<tfoot>
														    <tr>
														      <td colspan="6" align=right >Total de la Reteneción $</td>
														      <td align=center>0.00</td>
														    </tr>
														  </tfoot>
														<tbody>																		
														</tbody>																		
													</table>
												</div>
											</div>
										</form>
									</div>
									<div class="step-pane" data-step="3">	
										<form class="form-horizontal" id="form_FormaPago">														
											<div class="col-sm-12 col-md-6">															
												<div class="form-group">																
													<div class="col-xs-12 col-sm-12">
														<select id="select_formaPago" name="select_formaPago" class="chosen-select form-control" data-placeholder="Formas de Pago" chosen ng-model="recipientsFormaPago" ng-options = "recipientFormaPago.id as recipientFormaPago.title for recipientFormaPago in recipientsListFormaPago track by recipientFormaPago.id">								
															
														</select>																	
													</div>
												</div>
											</div>
											<div class="col-sm-12 col-md-2">
												<div class="form-group">																
													<div class="col-xs-12 col-sm-12">
														<div class="clearfix">
															<input type="text" name="txt_12" id="txt_12" ng-Model="FormaPago.txt_12" placeholder="Valor de Pago" class="form-control" />
														</div>
													</div>
												</div>	
											</div>
											<div class="col-sm-12 col-md-2">
												<div class="form-group">																
													<div class="col-xs-12 col-sm-12">
														<div class="clearfix">
															<input type="text" name="txt_13" id="txt_13" ng-Model="FormaPago.txt_13" placeholder="Total Pago" class="form-control" ng-disabled="true" />
														</div>
													</div>
												</div>	
											</div>
											<div class="col-xs-12 col-sm-2">
												<div class="form-group">	
													<div class="col-xs-12 col-sm-12">			
														<button type="button" id="btn_agregarFormaPago" class="btn btn-sm btn-primary col-sm-12" ng-click="agregarFormasPago()">
															Agregar															
														</button>			
													</div>
												</div>
											</div>
											<div class="col-xs-12 col-sm-12">
												<div class="form-group">
												<div class="col-sm-12 table-responsive">																
													<table id="tabla_formaPago" class="table table-striped table-bordered table-hover">
														<thead>
															<tr>
																<th style="display:none;">idCodigo</th>																			
																<th>Nombre</th>																			
																<th>Valor</th>
																<th></th>
															</tr>
														</thead>
														
														<tbody>																		
														</tbody>
														<tfoot>
														    <tr>
														    	<td colspan="2" align=right >Total Forma de Pago $</td>
														    	<td align=center>0.00</td>
														    	<td align=center></td>
														    </tr>
														  </tfoot>																		
													</table>
												</div>
											</div>
											</div>														
										</form>
									</div>
								</div>
							</div>
							<hr />
							<div class="wizard-actions">
								<button class="btn btn-prev">
									<i class="ace-icon fa fa-arrow-left"></i>
									Atras
								</button>								
								<button class="btn btn-success btn-next" data-last="Generar">
									Siguiente
									<i class="ace-icon fa fa-arrow-right icon-on-right"></i>
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="modal fade bs-example-modal-md" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="result" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-md">
      <div class="modal-content">
        <div class="modal-header">          
          <h4 class="modal-title"><b>Resultados del envío!</b></h4>
        </div>
        <div class="modal-body">
            <div class="row"> 
            	<div class="col-md-10">

            	</div>
            	<div class="col-md-2">
            		
            	</div>
		    </div>
        </div>
        <div class="modal-footer">
        	<button type="button" class="btn btn-info" id="pdf" data-toggle="tooltip" title="Cerrar ventana">Aceptar y Generar</button>
        	<button type="button" class="btn btn-danger" id="cerrar" data-toggle="tooltip" title="Cerrar ventana">Cerrar</button>
        </div>
      </div>
    </div>
</div>